/****** Object:  StoredProcedure [dbo].[spx_StyleBOM_DuplicateMaterials_INSERT]    Script Date: 05/16/2013 10:36:45 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spx_StyleBOM_DuplicateMaterials_INSERT]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[spx_StyleBOM_DuplicateMaterials_INSERT]
GO

/****** Object:  StoredProcedure [dbo].[spx_StyleBOM_DuplicateMaterials_INSERT]    Script Date: 05/16/2013 10:36:45 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[spx_StyleBOM_DuplicateMaterials_INSERT]
	@StyleBOMDimensionID UNIQUEIDENTIFIER,
	@StyleMaterialID UNIQUEIDENTIFIER
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    INSERT INTO pStyleBOM
           ([StyleMaterialID]
           ,[StyleMaterialMasterID]
           ,[CopyStyleMaterialID]
           ,[MainMaterial]
           ,[Development]
           ,[MiscColor]
           ,[StyleSet]
           ,[StyleID]
           ,[WorkflowId]
           ,[WorkflowItemId]
           ,[StyleBOMDimensionId]
           ,[Dim1TypeSel]
           ,[Dim2TypeSel]
           ,[Dim3TypeSel]
           ,[UOM]
           ,[Qty]
           ,[MaterialPrice]
           ,[Ext]
           ,[MaterialSize]
           ,[MaterialID]
           ,[MaterialPlacement]
           ,[MaterialPlacementCode]
           ,[MaterialPlacementDetail]
           ,[MaterialImageID]
           ,[MaterialImageVersion]
           ,[NoColorMatch]
           ,[SupplierID]
           ,[ComponentTypeID]
           ,[MaterialType]
           ,[MaterialNo]
           ,[MaterialName]
           ,[A]
           ,[B]
           ,[C]
           ,[D]
           ,[E]
           ,[F]
           ,[G]
           ,[H]
           ,[I]
           ,[J]
           ,[K]
           ,[L]
           ,[M]
           ,[N]
           ,[O]
           ,[P]
           ,[Q]
           ,[R]
           ,[S]
           ,[T]
           ,[U]
           ,[V]
           ,[W]
           ,[X]
           ,[Y]
           ,[Z]
           ,[Source]
           ,[Notes]
           ,[Placement]
           ,[VendorPrice]
           ,[VolumePrice]
           ,[VolumePriceMinimum]
           ,[VendorProductionMin]
           ,[VendorProductionLeadTime]
           ,[DetailYesNo]
           ,[ImageType]
           ,[height]
           ,[width]
           ,[CDate]
           ,[CUser]
           ,[MDate]
           ,[MUser]
           ,[MChange]
           ,[SChange]
           ,[DChange]
           ,[CChange]
           ,[Action]
           ,[ColorPlacement]
           ,[Artwork]
           ,[License]
           ,[Colorway]
           ,[MaterialSort]
           ,[MaterialTrack]
           ,[MaterialLinked]
           ,[MaterialDimension]
           ,[MaterialSizeA0]
           ,[MaterialSizeA1]
           ,[MaterialSizeA2]
           ,[MaterialSizeA3]
           ,[MaterialSizeA4]
           ,[MaterialSizeA5]
           ,[MaterialSizeA6]
           ,[MaterialSizeA7]
           ,[MaterialSizeA8]
           ,[MaterialSizeA9]
           ,[MaterialSizeA10]
           ,[MaterialSizeA11]
           ,[MaterialSizeA12]
           ,[MaterialSizeA13]
           ,[MaterialSizeA14]
           ,[MaterialSizeA15]
           ,[MaterialSizeA16]
           ,[MaterialSizeA17]
           ,[MaterialSizeA18]
           ,[MaterialSizeA19]
           ,[MaterialSizeB0]
           ,[MaterialSizeB1]
           ,[MaterialSizeB2]
           ,[MaterialSizeB3]
           ,[MaterialSizeB4]
           ,[MaterialSizeB5]
           ,[MaterialSizeB6]
           ,[MaterialSizeB7]
           ,[MaterialSizeB8]
           ,[MaterialSizeB9]
           ,[MaterialSizeB10]
           ,[MaterialSizeB11]
           ,[MaterialSizeB12]
           ,[MaterialSizeB13]
           ,[MaterialSizeB14]
           ,[MaterialSizeB15]
           ,[MaterialSizeB16]
           ,[MaterialSizeB17]
           ,[MaterialSizeB18]
           ,[MaterialSizeB19]
           ,[MaterialLining]
           ,[MaterialSizeID]
           ,[MaterialColorId]
           ,[MaterialPackLabelGroupID]
           ,[TradePartnerID]
           ,[TradePartnerVendorID]
           ,[MaterialBOM]
           ,[MaterialCode]
           ,[StyleMaterialLinkID]
           ,[MultiCloth]
           ,[MaterialCoreItemID]
           ,[MaterialSwing]
           ,[MaterialLinkID]
           ,[MultiMaterialParentID]
           ,[WebPDMCustom_Category]
           ,[WebPDMCustom_SubCategory]
           ,[WebPDMCustom_ItemTypeCode]
           ,[WebPDMCustom_Approved]
           ,[WebPDMCustom_Content]
           ,[WebPDMCustom_Finish]
           ,[WebPDMCustom_Construction]
           ,[WebPDMCustom_GroupDesc]
           ,[WebPDMCustom_Dutiable]
           ,[WebPDMCustom_WasteFactor]
           ,[WebPDMCustom_UOM]
           ,[WebPDMCustom_UOMPurchase]
           ,[WebPDMCustom_Comments]
           ,[AUTOCOLOR]
           ,[StyleMaterialCopyMasterID])
     SELECT
           NEWID()
           ,[StyleMaterialMasterID]
           ,[CopyStyleMaterialID]
           ,[MainMaterial]
           ,[Development]
           ,[MiscColor]
           ,[StyleSet]
           ,[StyleID]
           ,[WorkflowId]
           ,[WorkflowItemId]
           ,[StyleBOMDimensionId]
           ,[Dim1TypeSel]
           ,[Dim2TypeSel]
           ,[Dim3TypeSel]
           ,[UOM]
           ,[Qty]
           ,[MaterialPrice]
           ,[Ext]
           ,[MaterialSize]
           ,[MaterialID]
           ,[MaterialPlacement]
           ,[MaterialPlacementCode]
           ,[MaterialPlacementDetail]
           ,[MaterialImageID]
           ,[MaterialImageVersion]
           ,[NoColorMatch]
           ,[SupplierID]
           ,[ComponentTypeID]
           ,[MaterialType]
           ,[MaterialNo]
           ,[MaterialName]
           ,[A]
           ,[B]
           ,[C]
           ,[D]
           ,[E]
           ,[F]
           ,[G]
           ,[H]
           ,[I]
           ,[J]
           ,[K]
           ,[L]
           ,[M]
           ,[N]
           ,[O]
           ,[P]
           ,[Q]
           ,[R]
           ,[S]
           ,[T]
           ,[U]
           ,[V]
           ,[W]
           ,[X]
           ,[Y]
           ,[Z]
           ,[Source]
           ,[Notes]
           ,[Placement]
           ,[VendorPrice]
           ,[VolumePrice]
           ,[VolumePriceMinimum]
           ,[VendorProductionMin]
           ,[VendorProductionLeadTime]
           ,[DetailYesNo]
           ,[ImageType]
           ,[height]
           ,[width]
           ,GETDATE()
           ,[CUser]
           ,GETDATE()
           ,[MUser]
           ,[MChange]
           ,[SChange]
           ,[DChange]
           ,[CChange]
           ,[Action]
           ,[ColorPlacement]
           ,[Artwork]
           ,[License]
           ,[Colorway]
           ,[MaterialSort]
           ,[MaterialTrack]
           ,[MaterialLinked]
           ,[MaterialDimension]
           ,[MaterialSizeA0]
           ,[MaterialSizeA1]
           ,[MaterialSizeA2]
           ,[MaterialSizeA3]
           ,[MaterialSizeA4]
           ,[MaterialSizeA5]
           ,[MaterialSizeA6]
           ,[MaterialSizeA7]
           ,[MaterialSizeA8]
           ,[MaterialSizeA9]
           ,[MaterialSizeA10]
           ,[MaterialSizeA11]
           ,[MaterialSizeA12]
           ,[MaterialSizeA13]
           ,[MaterialSizeA14]
           ,[MaterialSizeA15]
           ,[MaterialSizeA16]
           ,[MaterialSizeA17]
           ,[MaterialSizeA18]
           ,[MaterialSizeA19]
           ,[MaterialSizeB0]
           ,[MaterialSizeB1]
           ,[MaterialSizeB2]
           ,[MaterialSizeB3]
           ,[MaterialSizeB4]
           ,[MaterialSizeB5]
           ,[MaterialSizeB6]
           ,[MaterialSizeB7]
           ,[MaterialSizeB8]
           ,[MaterialSizeB9]
           ,[MaterialSizeB10]
           ,[MaterialSizeB11]
           ,[MaterialSizeB12]
           ,[MaterialSizeB13]
           ,[MaterialSizeB14]
           ,[MaterialSizeB15]
           ,[MaterialSizeB16]
           ,[MaterialSizeB17]
           ,[MaterialSizeB18]
           ,[MaterialSizeB19]
           ,[MaterialLining]
           ,[MaterialSizeID]
           ,[MaterialColorId]
           ,[MaterialPackLabelGroupID]
           ,[TradePartnerID]
           ,[TradePartnerVendorID]
           ,[MaterialBOM]
           ,[MaterialCode]
           ,[StyleMaterialLinkID]
           ,[MultiCloth]
           ,[MaterialCoreItemID]
           ,[MaterialSwing]
           ,[MaterialLinkID]
           ,[MultiMaterialParentID]
           ,[WebPDMCustom_Category]
           ,[WebPDMCustom_SubCategory]
           ,[WebPDMCustom_ItemTypeCode]
           ,[WebPDMCustom_Approved]
           ,[WebPDMCustom_Content]
           ,[WebPDMCustom_Finish]
           ,[WebPDMCustom_Construction]
           ,[WebPDMCustom_GroupDesc]
           ,[WebPDMCustom_Dutiable]
           ,[WebPDMCustom_WasteFactor]
           ,[WebPDMCustom_UOM]
           ,[WebPDMCustom_UOMPurchase]
           ,[WebPDMCustom_Comments]
           ,[AUTOCOLOR]
           ,[StyleMaterialCopyMasterID]
     FROM pStyleBOM 
     WHERE StyleMaterialID = @StyleMaterialID AND StyleBOMDimensionId = @StyleBOMDimensionID
END

GO

INSERT INTO sVersion(AppName, Version, LastScriptRun, TimeStamp)
VALUES     ('DB_Version', '0.5.0.0000', '05683', GetDate())
GO
