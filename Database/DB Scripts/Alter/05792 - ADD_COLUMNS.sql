IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='Mapping' AND COLUMN_NAME='IsSeasonal')
BEGIN
	ALTER TABLE Mapping ADD IsSeasonal INT DEFAULT 0
END
GO

IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='pStyleWorkflow' AND COLUMN_NAME='StyleSeasonYearID')
BEGIN
	ALTER TABLE pStyleWorkflow ADD StyleSeasonYearID UNIQUEIDENTIFIER NULL
END
GO

IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='pWorkFlowItem' AND COLUMN_NAME='StyleSeasonYearID')
BEGIN
	ALTER TABLE pWorkFlowItem ADD StyleSeasonYearID UNIQUEIDENTIFIER NULL
END
GO

UPDATE Mapping SET IsSeasonal = 0
UPDATE Mapping SET IsSeasonal = 1
WHERE Map IN (
	'40000000-0000-0000-0000-000000000004', 
	'10000000-0000-0000-0000-000000000010', 
	'60000000-0000-0000-0000-000000000666', 
	'40000000-0000-0000-0000-000000000888',
	'40000000-0000-0000-0000-000000000021',
	'40000000-0000-0000-0000-000000000085')
GO


INSERT INTO sVersion(AppName, Version, LastScriptRun, TimeStamp)
VALUES ('DB_Version', '0.5.0.0000', '05792', GetDate())
GO
